javascript:(function(){console.log('扩展程序开始执行');var paperDatastr=window.paperDatastr||null;console.log('paperDatastr:',paperDatastr);if(!paperDatastr){console.log('尝试从script标签中查找paperDatastr');var scripts=document.getElementsByTagName('script');for(var i=0;i<scripts.length;i++){var scriptContent=scripts[i].textContent;if(scriptContent.indexOf('var paperDatastr')!==-1){var match=scriptContent.match(/var paperDatastr\s*=\s*JSON\.stringify\((\[.*\])\);/s);if(match&&match[1]){try{paperDatastr=JSON.stringify(JSON.parse(match[1]));console.log('从script标签中找到paperDatastr');}catch(e){console.error('解析script标签中的paperDatastr失败:',e);}break;}}}}if(!paperDatastr){console.log('未找到paperDatastr，尝试其他方式获取数据');var dataScript=document.querySelector('script[type="application/json"]');if(dataScript){try{paperDatastr=dataScript.textContent;console.log('从JSON script标签中找到数据');}catch(e){console.error('解析JSON script标签失败:',e);}}}if(!paperDatastr){console.log('未找到paperDatastr，退出执行');return;}var paperData=JSON.parse(paperDatastr);console.log('解析后的paperData:',paperData);var subjects=document.querySelectorAll('.exam-subject, .exercise-subject');console.log('找到的题目数量:',subjects.length);subjects.forEach(function(subjectDiv){var qidInput=subjectDiv.querySelector('input[name="questionId"]');if(!qidInput){console.log('未找到questionId输入框');return;}var qid=qidInput.value;console.log('当前题目ID:',qid);var item=paperData.find(function(q){return q.questionId==qid;});if(!item){console.log('未找到对应答案');return;}console.log('找到的答案:',item.answer);var answer=item.answer;var isChoiceQuestion=['A','B','C','D'].includes(answer);if(isChoiceQuestion){var optionInput=subjectDiv.querySelector('input[type="radio"][value="'+answer+'"]');if(optionInput){var label=optionInput.closest('label');if(label){var textNodes=Array.from(label.childNodes).filter(n=>n.nodeType===3);if(textNodes.length>0&&!textNodes[0].textContent.trim().endsWith('.')){textNodes[0].textContent=textNodes[0].textContent.trim()+'.';console.log('已标记正确答案');}}}else{console.log('未找到对应答案的选项');}}else{var inputElement=subjectDiv.querySelector('textarea, input[type="text"]');if(inputElement){inputElement.value=answer;console.log('已填充答案到输入框');}else{console.log('未找到输入框,尝试在题目后显示答案');var questionText=subjectDiv.querySelector('.question-text, .subject-title, .subject-content, .subject-text, .question-content, .question-title, .subject, .question');if(!questionText){var textElements=subjectDiv.querySelectorAll('div, p, span');for(var i=0;i<textElements.length;i++){if(textElements[i].textContent.trim()&&!textElements[i].querySelector('input')){questionText=textElements[i];break;}}}if(questionText){var answerSpan=document.createElement('div');answerSpan.style.color='red';answerSpan.style.marginTop='5px';answerSpan.style.fontWeight='bold';answerSpan.textContent='答案: '+answer;questionText.parentNode.insertBefore(answerSpan,questionText.nextSibling);console.log('已在题目后显示答案');}else{console.log('未找到题目文本元素,尝试在subjectDiv后添加答案');var answerSpan=document.createElement('div');answerSpan.style.color='red';answerSpan.style.marginTop='5px';answerSpan.style.fontWeight='bold';answerSpan.textContent='答案: '+answer;subjectDiv.appendChild(answerSpan);}}}});})(); 